# Shapeはワークロードで選ぶ

## timeseries_long（縦持ち）
向く：
- タグが多い / 増える
- ad-hoc分析（フィルタ、集計、派生列）
- スキーマ変更が起きる
- 工場差異吸収（追加列や拡張）

向かない：
- 固定タグの多系列比較を毎回やる（可視化が重い）
- 低遅延の“同じクエリを多数ユーザ”に配る

---

## timeseries_wide（横持ち：時間×タグ）
向く：
- 固定タグ集合での比較（ダッシュボード）
- 同時系列の可視化
- 低遅延の配信

注意：
- wideは「投影」。canonical（正本）にすると変更で壊れる。

---

## event_log（イベント）
向く：
- 状態変化（RUN/STOP、モード、アラーム、段取りなど）
- 変化点が疎（全部の点はいらない）
- 監査・説明（なぜ今こうなったか）

---

## snapshot_table（スナップショット）
向く：
- “ある時点の状態”の配布
- 合意済み指標/KPIの参照
- 多数ユーザの参照（Serving）

---

## まとめ（最短）
- 分析・拡張 → long
- 比較・可視化・配信 → wide（ただし投影）
- 状態と変化 → event
- 配布と参照 → snapshot
