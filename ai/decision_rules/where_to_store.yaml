version: 1.0
kind: storage_decision_rules
id: where_to_store_factory_data

intent:
  - Decide whether data should be stored
  - Decide where responsibility is fixed
  - Avoid irreversible semantic freeze

assumptions:
  - Data meaning may change after collection
  - Not all data needs to be stored
  - Storage implies responsibility

decision_flow:

  - step: is_fact_stable
    question: >
      Is the meaning of this data stable at the time of storage?
    if_yes: next
    if_no: do_not_store
    note: >
      If meaning depends on future interpretation,
      storing it freezes assumptions too early.

  - step: is_reproducible
    question: >
      Can this data be reproduced from upstream sources?
    if_yes: consider_not_storing
    if_no: next
    note: >
      Irreproducible data has higher storage priority.

  - step: responsibility_owner
    question: >
      Who takes responsibility for correctness after storage?
    options:
      - upstream_system
      - storage_layer
      - downstream_application
    rule: >
      Responsibility must be explicit.
      If unclear, storage is deferred.

  - step: quality_state
    question: >
      Is data quality known at storage time?
    options:
      - normal
      - abnormal
      - corrected
      - unknown
    rule: >
      Unknown quality must not be stored as fact.
      Mark or delay storage.

  - step: usage_scope
    question: >
      Is this data used for operations or analysis only?
    options:
      - operations
      - analytics
      - unknown
    rule: >
      Analytics-only usage does not justify irreversible storage.

storage_targets:

  db:
    when:
      - fact_is_stable
      - responsibility_defined
    risks:
      - semantic_freeze
      - schema_lock

  tsdb:
    when:
      - time_series
      - operational_monitoring
    risks:
      - false_precision
      - retention_assumptions

  object_storage:
    when:
      - raw_data
      - future_reinterpretation_expected
    risks:
      - forgotten_context
      - uncontrolled_usage

do_not_store_conditions:
  - meaning_not_fixed
  - responsibility_unclear
  - quality_unknown
  - reproducible_and_low_value

output:
  decision:
    - store_now
    - store_later
    - do_not_store
    - store_as_raw_only

notes:
  - Storage is irreversible
  - Deferring storage is a valid decision
  - "Just in case" is not a rule
